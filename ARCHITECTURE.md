# ğŸŒ¾ Agri Mitra - Architecture & Connection Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER BROWSER                              â”‚
â”‚  http://localhost:5000 (development) or https://agrimitra.com   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                    HTTP Requests
                                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                                            â”‚
        â”‚             Flask Backend (Port 5000)                    â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: GET /                                        â”‚ â”‚
        â”‚  â”‚ â†’ Serves: index.html + home.css + home.js          â”‚ â”‚
        â”‚  â”‚ â†’ Browser loads config.js (sets API_BASE)          â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: GET /farmer.html                             â”‚ â”‚
        â”‚  â”‚ â†’ Serves: farmer.html + farmer.css + farmer.js     â”‚ â”‚
        â”‚  â”‚ â†’ farmer.js uses: window.API_BASE                  â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: POST /api/send-otp                           â”‚ â”‚
        â”‚  â”‚ â””â”€â†’ auth.py â†’ send_otp()                          â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Validate phone                              â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Generate/Get demo OTP                       â”‚ â”‚
        â”‚  â”‚    â””â”€ Insert into otp_store table                 â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: POST /api/login                              â”‚ â”‚
        â”‚  â”‚ â””â”€â†’ auth.py â†’ login()                             â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Verify OTP                                  â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Query users table                           â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Create JWT token                            â”‚ â”‚
        â”‚  â”‚    â””â”€ Return token + user data                    â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: POST /api/register                           â”‚ â”‚
        â”‚  â”‚ â””â”€â†’ auth.py â†’ register()                          â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Validate inputs                             â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Verify OTP                                  â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Insert new user                             â”‚ â”‚
        â”‚  â”‚    â””â”€ Return success                              â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: GET /api/me                                  â”‚ â”‚
        â”‚  â”‚ â””â”€â†’ profile.py â†’ get_me()                         â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Verify JWT token                            â”‚ â”‚
        â”‚  â”‚    â””â”€ Return current user data                    â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: POST /api/ask                                â”‚ â”‚
        â”‚  â”‚ â””â”€â†’ ai.py â†’ ask_ai()                              â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Parse question                              â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Call OpenRouter API                         â”‚ â”‚
        â”‚  â”‚    â”œâ”€ Process response                            â”‚ â”‚
        â”‚  â”‚    â””â”€ Return AI answer                            â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Route: GET /api/health                              â”‚ â”‚
        â”‚  â”‚ â†’ Returns: {"status": "ok", "service": "..."}      â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                                                            â”‚
        â”‚                     CORS: enabled                         â”‚
        â”‚              Credentials: allowed                         â”‚
        â”‚                                                            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                    SQL Queries
                                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   MySQL Database                         â”‚
        â”‚                   (localhost:3306)                       â”‚
        â”‚                                                           â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚ Table: users                                     â”‚   â”‚
        â”‚  â”‚ â”œâ”€ id (INT, PRIMARY KEY)                        â”‚   â”‚
        â”‚  â”‚ â”œâ”€ full_name (VARCHAR)                          â”‚   â”‚
        â”‚  â”‚ â”œâ”€ phone (VARCHAR, UNIQUE)                      â”‚   â”‚
        â”‚  â”‚ â”œâ”€ age, dob, location                           â”‚   â”‚
        â”‚  â”‚ â”œâ”€ preferred_language, soil_type               â”‚   â”‚
        â”‚  â”‚ â””â”€ created_at, updated_at                       â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚                                                           â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚ Table: otp_store                                 â”‚   â”‚
        â”‚  â”‚ â”œâ”€ id (INT, PRIMARY KEY)                        â”‚   â”‚
        â”‚  â”‚ â”œâ”€ phone (VARCHAR)                              â”‚   â”‚
        â”‚  â”‚ â”œâ”€ otp (VARCHAR)                                â”‚   â”‚
        â”‚  â”‚ â””â”€ created_at (TIMESTAMP)                       â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚                                                           â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚  â”‚ Table: user_crops                                â”‚   â”‚
        â”‚  â”‚ â”œâ”€ id, user_id, crop_name                       â”‚   â”‚
        â”‚  â”‚ â”œâ”€ sowing_date, harvesting_date                 â”‚   â”‚
        â”‚  â”‚ â””â”€ status, yield                                â”‚   â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚                                                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Sequence

### 1. User Registration Flow

```
Browser                                Frontend/Backend        MySQL
  â”‚                                           â”‚                 â”‚
  â”‚â”€â”€â”€ Open http://localhost:5000 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚â†â”€â”€â”€ index.html + home.css + home.js â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚â”€â”€â”€ Click "Register" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚     farmer.html loads                     â”‚                 â”‚
  â”‚     config.js sets API_BASE               â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚â”€â”€â”€ Enter phone: 9876543210 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚â”€â”€â”€ Click "Send OTP" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚     fetch('/api/send-otp', {             â”‚                 â”‚
  â”‚       phone: '9876543210'                â”‚                 â”‚
  â”‚     })                                    â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
  â”‚                                 â”‚ auth.py:send_otp()â”‚       â”‚
  â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
  â”‚                                           â”‚                 â”‚
  â”‚                                 Generate OTP: 1234          â”‚
  â”‚                                           â”‚                 â”‚
  â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚                                    â”‚ INSERT INTO ... â”‚      â”‚
  â”‚                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                           â”‚                 â”‚
  â”‚â†â”€â”€â”€ {"demo_otp": "1234"} â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚â”€â”€â”€ Enter OTP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚â”€â”€â”€ Fill registration form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚â”€â”€â”€ Click "Register" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚     fetch('/api/register', {              â”‚                 â”‚
  â”‚       phone, full_name, age, dob, ...    â”‚                 â”‚
  â”‚     })                                    â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
  â”‚                                 â”‚ auth.py:register()â”‚       â”‚
  â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
  â”‚                                           â”‚                 â”‚
  â”‚                                 Verify OTP in table         â”‚
  â”‚                                           â”‚                 â”‚
  â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚                                    â”‚ INSERT INTO ... â”‚      â”‚
  â”‚                                    â”‚ (new user)      â”‚      â”‚
  â”‚                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                           â”‚                 â”‚
  â”‚â†â”€â”€â”€ {"message": "Registered", ...} â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                                           â”‚                 â”‚
  â”‚â”€â”€â”€ Redirect to login â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
```

### 2. API Request with Token

```
Browser                          Backend                      Database
  â”‚                                â”‚                             â”‚
  â”‚  User has JWT token stored    â”‚                             â”‚
  â”‚                                â”‚                             â”‚
  â”‚â”€ fetch('/api/me', {          â”‚                             â”‚
  â”‚   headers: {                 â”‚                             â”‚
  â”‚     'Authorization':         â”‚                             â”‚
  â”‚       'Bearer <token>'       â”‚                             â”‚
  â”‚   }                          â”‚                             â”‚
  â”‚ })                           â”‚                             â”‚
  â”‚                              â”‚                             â”‚
  â”‚â”€â”€â”€â”€â”€â”€ GET /api/me â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                             â”‚
  â”‚                              â”‚                             â”‚
  â”‚                      Profile.py:get_me()                   â”‚
  â”‚                      â”œâ”€ Verify JWT                         â”‚
  â”‚                      â”œâ”€ Extract user_id                    â”‚
  â”‚                      â”‚                                      â”‚
  â”‚                      â”‚â”€â”€â”€â”€â”€â”€ SELECT * FROM users â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚                      â”‚       WHERE id = <user_id>          â”‚
  â”‚                      â”‚                                      â”‚
  â”‚                      â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”
  â”‚                      â”‚                              â”‚ Query OK  â”‚
  â”‚                      â”‚                              â”‚ Return    â”‚
  â”‚                      â”‚                              â”‚ user_id   â”‚
  â”‚                      â”‚                              â”‚ 123       â”‚
  â”‚                      â”‚                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
  â”‚                      â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€ user_data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                      â”‚                                      â”‚
  â”‚â†â”€â”€â”€â”€â”€ {user_data} â”€â”€â”€â”‚                                     â”‚
  â”‚                      â”‚                                     â”‚
  â”‚ JavaScript updates   â”‚                                     â”‚
  â”‚ page with user data  â”‚                                     â”‚
```

---

## Configuration Files

```
Environment (.env)
    â†“
Config.py (reads .env)
    â†“
app.py (uses Config)
    â”œâ”€ Creates Flask app
    â”œâ”€ Registers blueprints
    â””â”€ Serves frontend files
```

---

## Frontend to Backend URL Mapping

```
Browser Request          â†’    Backend Route          â†’    Handler Function
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GET /                    â†’    app.py (Flask)         â†’    Serve index.html
GET /farmer.html         â†’    serve_static()         â†’    Serve farmer.html
GET /farmer.js           â†’    serve_static()         â†’    Serve farmer.js
GET /config.js           â†’    serve_static()         â†’    Serve config.js
GET /home.css            â†’    serve_static()         â†’    Serve home.css

POST /api/send-otp       â†’    /api               â†’    auth.py:send_otp()
POST /api/register       â†’    /api               â†’    auth.py:register()
POST /api/login          â†’    /api               â†’    auth.py:login()
GET /api/me              â†’    /api               â†’    profile.py:get_me()
PUT /api/profile         â†’    /api               â†’    profile.py:update()
POST /api/ask            â†’    /api               â†’    ai.py:ask_ai()
GET /api/health          â†’    app.py (Flask)         â†’    Health check
```

---

## Development Mode

```
Developer                Python CLI               Backend
    â”‚                         â”‚                      â”‚
    â”‚â”€ python cli.py run â”€â”€â”€â”€â†’â”‚                      â”‚
    â”‚                         â”‚                      â”‚
    â”‚                   Check dependencies          â”‚
    â”‚                   â”œâ”€ Flask installed?         â”‚
    â”‚                   â”œâ”€ MySQL available?         â”‚
    â”‚                   â””â”€ Database ready?          â”‚
    â”‚                         â”‚                      â”‚
    â”‚                   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”              â”‚
    â”‚                   â”‚ app.py      â”‚              â”‚
    â”‚                   â”‚ starts      â”‚              â”‚
    â”‚                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â”‚                         â”‚                      â”‚
    â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚                         â”‚                      â”‚
    â”‚                         â”‚ âœ“ Running on        â”‚
    â”‚                         â”‚   port 5000         â”‚
    â”‚                         â”‚ âœ“ Debug mode ON     â”‚
    â”‚                         â”‚ âœ“ Auto-reload ON    â”‚
    â”‚                         â”‚                      â”‚
    â”‚â”€ Open localhost:5000 â”€â”€â†’â”‚ Browser Request     â”‚
    â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ Returns HTML
    â”‚â† Agri Mitra Page â”€â”€â”€â”€â”€â”€â”€â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

---

## Production Mode

```
User               Internet          Reverse Proxy       Gunicorn       MySQL
  â”‚                   â”‚                    â”‚               â”‚             â”‚
  â”‚â”€ HTTPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                    â”‚               â”‚             â”‚
  â”‚  agrimitra.com    â”‚                    â”‚               â”‚             â”‚
  â”‚                   â”‚â”€ Forward â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚               â”‚             â”‚
  â”‚                   â”‚                    â”‚               â”‚             â”‚
  â”‚                   â”‚         Route      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚             â”‚
  â”‚                   â”‚         /api/ask   â”‚ 4 Workers    â”‚             â”‚
  â”‚                   â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚             â”‚
  â”‚                   â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚             â”‚
  â”‚                   â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ Query       â”‚
  â”‚                   â”‚                    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”        â”‚
  â”‚                   â”‚                    â”‚       â”‚ Process  â”‚        â”‚
  â”‚                   â”‚                    â”‚       â”‚ Request  â”‚        â”‚
  â”‚                   â”‚                    â”‚       â”‚          â”‚        â”‚
  â”‚                   â”‚                    â”‚       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”   â”‚
  â”‚                   â”‚                    â”‚       â”‚ â”‚ SELECT ... â”‚   â”‚
  â”‚                   â”‚                    â”‚       â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚                   â”‚                    â”‚       â”‚       â”‚          â”‚
  â”‚                   â”‚                    â”‚       â”‚       Response  â”‚
  â”‚                   â”‚                    â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚                   â”‚     JSON           â”‚                         â”‚
  â”‚â†â”€ HTTPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚
```

---

## Error Handling Flow

```
User Action (e.g., Login)
    â†“
Frontend: fetch('http://localhost:5000/api/login', {...})
    â†“
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”œâ”€ Network Error
    â”‚  â””â”€ "Backend is not running"
    â”‚     â””â”€ User sees: "Network error. Is backend running?"
    â”‚
    â”œâ”€ HTTP Error (e.g., 400, 500)
    â”‚  â””â”€ Response: {"error": "Invalid OTP"}
    â”‚     â””â”€ User sees: Error message from API
    â”‚
    â”œâ”€ Validation Error (Frontend)
    â”‚  â””â”€ Phone format check fails
    â”‚     â””â”€ User sees: "Please enter valid 10-digit number"
    â”‚
    â”œâ”€ Database Error
    â”‚  â””â”€ Response: {"error": "Database connection failed"}
    â”‚     â””â”€ User sees: "Error. Try again later."
    â”‚
    â””â”€ Success
       â””â”€ Response: {"token": "...", "user": {...}}
          â””â”€ User sees: Redirected to home page
```

---

## Key Technologies

```
Frontend                Backend              Database
â”œâ”€ HTML5              â”œâ”€ Flask 3.0          â”œâ”€ MySQL 5.7+
â”œâ”€ CSS3               â”œâ”€ Python 3.8+        â””â”€ PyMySQL
â”œâ”€ JavaScript (ES6)   â”œâ”€ PyJWT              
â”œâ”€ Fetch API          â”œâ”€ python-dotenv      Tools
â””â”€ localStorage       â”œâ”€ CORS Middleware    â”œâ”€ pip
                      â””â”€ Blueprints         â”œâ”€ git
                                            â”œâ”€ MySQL CLI
                                            â””â”€ curl (testing)
```

---

**This architecture ensures clean separation between frontend and backend while maintaining easy communication through RESTful APIs.**
